{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "8b738149-3945-4eaa-bfbb-30a262a16deb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: geopy in c:\\users\\mitishah\\anaconda3\\lib\\site-packages (2.4.1)\n",
      "Requirement already satisfied: geographiclib<3,>=1.52 in c:\\users\\mitishah\\anaconda3\\lib\\site-packages (from geopy) (2.0)\n",
      "Requirement already satisfied: folium in c:\\users\\mitishah\\anaconda3\\lib\\site-packages (0.17.0)\n",
      "Requirement already satisfied: branca>=0.6.0 in c:\\users\\mitishah\\anaconda3\\lib\\site-packages (from folium) (0.7.2)\n",
      "Requirement already satisfied: jinja2>=2.9 in c:\\users\\mitishah\\anaconda3\\lib\\site-packages (from folium) (3.1.4)\n",
      "Requirement already satisfied: numpy in c:\\users\\mitishah\\anaconda3\\lib\\site-packages (from folium) (1.26.4)\n",
      "Requirement already satisfied: requests in c:\\users\\mitishah\\anaconda3\\lib\\site-packages (from folium) (2.32.2)\n",
      "Requirement already satisfied: xyzservices in c:\\users\\mitishah\\anaconda3\\lib\\site-packages (from folium) (2022.9.0)\n",
      "Requirement already satisfied: MarkupSafe>=2.0 in c:\\users\\mitishah\\anaconda3\\lib\\site-packages (from jinja2>=2.9->folium) (2.1.3)\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in c:\\users\\mitishah\\anaconda3\\lib\\site-packages (from requests->folium) (2.0.4)\n",
      "Requirement already satisfied: idna<4,>=2.5 in c:\\users\\mitishah\\anaconda3\\lib\\site-packages (from requests->folium) (3.7)\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in c:\\users\\mitishah\\anaconda3\\lib\\site-packages (from requests->folium) (2.2.2)\n",
      "Requirement already satisfied: certifi>=2017.4.17 in c:\\users\\mitishah\\anaconda3\\lib\\site-packages (from requests->folium) (2024.7.4)\n"
     ]
    }
   ],
   "source": [
    "!pip install geopy\n",
    "!pip install folium\n",
    "import pandas as pd\n",
    "import folium\n",
    "from IPython.display import display, HTML\n",
    "from geopy.geocoders import Nominatim\n",
    "import requests\n",
    "from branca.element import Template, MacroElement\n",
    "import random"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "68b79c94-05df-45f3-b1b2-a4caf1fee736",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div style=\"width:100%;\"><div style=\"position:relative;width:100%;height:0;padding-bottom:60%;\"><span style=\"color:#565656\">Make this Notebook Trusted to load map: File -> Trust Notebook</span><iframe srcdoc=\"&lt;!DOCTYPE html&gt;\n",
       "&lt;html&gt;\n",
       "&lt;head&gt;\n",
       "    \n",
       "    &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;\n",
       "    \n",
       "        &lt;script&gt;\n",
       "            L_NO_TOUCH = false;\n",
       "            L_DISABLE_3D = false;\n",
       "        &lt;/script&gt;\n",
       "    \n",
       "    &lt;style&gt;html, body {width: 100%;height: 100%;margin: 0;padding: 0;}&lt;/style&gt;\n",
       "    &lt;style&gt;#map {position:absolute;top:0;bottom:0;right:0;left:0;}&lt;/style&gt;\n",
       "    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;&gt;&lt;/script&gt;\n",
       "    &lt;script src=&quot;https://code.jquery.com/jquery-3.7.1.min.js&quot;&gt;&lt;/script&gt;\n",
       "    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;\n",
       "    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;&gt;&lt;/script&gt;\n",
       "    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/&gt;\n",
       "    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/&gt;\n",
       "    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css&quot;/&gt;\n",
       "    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/&gt;\n",
       "    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/&gt;\n",
       "    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/&gt;\n",
       "    \n",
       "            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,\n",
       "                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; /&gt;\n",
       "            &lt;style&gt;\n",
       "                #map_054942086f2ae4b5ef16c5ebf3c2349d {\n",
       "                    position: relative;\n",
       "                    width: 100.0%;\n",
       "                    height: 100.0%;\n",
       "                    left: 0.0%;\n",
       "                    top: 0.0%;\n",
       "                }\n",
       "                .leaflet-container { font-size: 1rem; }\n",
       "            &lt;/style&gt;\n",
       "        \n",
       "&lt;/head&gt;\n",
       "&lt;body&gt;\n",
       "    \n",
       "    \n",
       "            &lt;div class=&quot;folium-map&quot; id=&quot;map_054942086f2ae4b5ef16c5ebf3c2349d&quot; &gt;&lt;/div&gt;\n",
       "        \n",
       "&lt;/body&gt;\n",
       "&lt;script&gt;\n",
       "    \n",
       "    \n",
       "            var map_054942086f2ae4b5ef16c5ebf3c2349d = L.map(\n",
       "                &quot;map_054942086f2ae4b5ef16c5ebf3c2349d&quot;,\n",
       "                {\n",
       "                    center: [4.729117777777777, 20.421554],\n",
       "                    crs: L.CRS.EPSG3857,\n",
       "                    zoom: 2,\n",
       "                    zoomControl: true,\n",
       "                    preferCanvas: false,\n",
       "                }\n",
       "            );\n",
       "\n",
       "            \n",
       "\n",
       "        \n",
       "    \n",
       "            var tile_layer_9089540e3ea3c81026e241b203bd799b = L.tileLayer(\n",
       "                &quot;https://tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,\n",
       "                {&quot;attribution&quot;: &quot;\\u0026copy; \\u003ca href=\\&quot;https://www.openstreetmap.org/copyright\\&quot;\\u003eOpenStreetMap\\u003c/a\\u003e contributors&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 19, &quot;maxZoom&quot;: 19, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}\n",
       "            );\n",
       "        \n",
       "    \n",
       "            tile_layer_9089540e3ea3c81026e241b203bd799b.addTo(map_054942086f2ae4b5ef16c5ebf3c2349d);\n",
       "        \n",
       "    \n",
       "            var marker_8a2aefa6425d7851aba7b4aac670c5a0 = L.marker(\n",
       "                [1.29027, 36.821945],\n",
       "                {}\n",
       "            ).addTo(map_054942086f2ae4b5ef16c5ebf3c2349d);\n",
       "        \n",
       "    \n",
       "            var icon_ce11a1c765e7ae71ce4ceec700df4d45 = L.AwesomeMarkers.icon(\n",
       "                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;#3237f8&quot;, &quot;markerColor&quot;: &quot;white&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}\n",
       "            );\n",
       "            marker_8a2aefa6425d7851aba7b4aac670c5a0.setIcon(icon_ce11a1c765e7ae71ce4ceec700df4d45);\n",
       "        \n",
       "    \n",
       "        var popup_4b371af6642c3f07ccd27a449c81d796 = L.popup({&quot;maxWidth&quot;: 300});\n",
       "\n",
       "        \n",
       "            \n",
       "                var html_b047141a1027c663bf30b95d2c52e4c6 = $(`&lt;div id=&quot;html_b047141a1027c663bf30b95d2c52e4c6&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;&lt;b&gt;Activity Name:&lt;/b&gt; Kenya Higher Education Partnerhsips&lt;br&gt;&lt;b&gt;Exact Site Name:&lt;/b&gt; Open University of Kenya&lt;br&gt;&lt;b&gt;General Comments:&lt;/b&gt; Consultation and Exploration of EdTech Africa partnership&lt;/div&gt;`)[0];\n",
       "                popup_4b371af6642c3f07ccd27a449c81d796.setContent(html_b047141a1027c663bf30b95d2c52e4c6);\n",
       "            \n",
       "        \n",
       "\n",
       "        marker_8a2aefa6425d7851aba7b4aac670c5a0.bindPopup(popup_4b371af6642c3f07ccd27a449c81d796)\n",
       "        ;\n",
       "\n",
       "        \n",
       "    \n",
       "    \n",
       "            var marker_7f2afb53ac8da5b8e421343e4649fbb0 = L.marker(\n",
       "                [1.286389, 36.817223],\n",
       "                {}\n",
       "            ).addTo(map_054942086f2ae4b5ef16c5ebf3c2349d);\n",
       "        \n",
       "    \n",
       "            var icon_1d8fc5f6b0cb65155ec2a95f98bca634 = L.AwesomeMarkers.icon(\n",
       "                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;#3237f8&quot;, &quot;markerColor&quot;: &quot;white&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}\n",
       "            );\n",
       "            marker_7f2afb53ac8da5b8e421343e4649fbb0.setIcon(icon_1d8fc5f6b0cb65155ec2a95f98bca634);\n",
       "        \n",
       "    \n",
       "        var popup_5c4d192467f00fe2f3d17390750e6118 = L.popup({&quot;maxWidth&quot;: 300});\n",
       "\n",
       "        \n",
       "            \n",
       "                var html_c15686fb4ce426c28d54c198456b5059 = $(`&lt;div id=&quot;html_c15686fb4ce426c28d54c198456b5059&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;&lt;b&gt;Activity Name:&lt;/b&gt; Kenya Higher Education Partnerhsips&lt;br&gt;&lt;b&gt;Exact Site Name:&lt;/b&gt; University of Nairobi&lt;br&gt;&lt;b&gt;General Comments:&lt;/b&gt; Consultation and Exploration of EdTech Africa partnership&lt;/div&gt;`)[0];\n",
       "                popup_5c4d192467f00fe2f3d17390750e6118.setContent(html_c15686fb4ce426c28d54c198456b5059);\n",
       "            \n",
       "        \n",
       "\n",
       "        marker_7f2afb53ac8da5b8e421343e4649fbb0.bindPopup(popup_5c4d192467f00fe2f3d17390750e6118)\n",
       "        ;\n",
       "\n",
       "        \n",
       "    \n",
       "    \n",
       "            var marker_3bf3adbc6011b0cb38a75e0e9c6fdc54 = L.marker(\n",
       "                [1.303454, 36.831017],\n",
       "                {}\n",
       "            ).addTo(map_054942086f2ae4b5ef16c5ebf3c2349d);\n",
       "        \n",
       "    \n",
       "            var icon_bc2e3f87f121879c753213240c2699a7 = L.AwesomeMarkers.icon(\n",
       "                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;#3237f8&quot;, &quot;markerColor&quot;: &quot;white&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}\n",
       "            );\n",
       "            marker_3bf3adbc6011b0cb38a75e0e9c6fdc54.setIcon(icon_bc2e3f87f121879c753213240c2699a7);\n",
       "        \n",
       "    \n",
       "        var popup_4f8793672c56fcdf435573cc23727404 = L.popup({&quot;maxWidth&quot;: 300});\n",
       "\n",
       "        \n",
       "            \n",
       "                var html_18e3274134835af126705646044dd683 = $(`&lt;div id=&quot;html_18e3274134835af126705646044dd683&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;&lt;b&gt;Activity Name:&lt;/b&gt; Kenya Higher Education Partnerhsips&lt;br&gt;&lt;b&gt;Exact Site Name:&lt;/b&gt; Micrsoft Research, Africa&lt;br&gt;&lt;b&gt;General Comments:&lt;/b&gt; Consultation and Exploration of EdTech Africa partnership&lt;/div&gt;`)[0];\n",
       "                popup_4f8793672c56fcdf435573cc23727404.setContent(html_18e3274134835af126705646044dd683);\n",
       "            \n",
       "        \n",
       "\n",
       "        marker_3bf3adbc6011b0cb38a75e0e9c6fdc54.bindPopup(popup_4f8793672c56fcdf435573cc23727404)\n",
       "        ;\n",
       "\n",
       "        \n",
       "    \n",
       "    \n",
       "            var marker_b7e7fd0f34f5eb87708156afdb37bb85 = L.marker(\n",
       "                [0.566245, 37.307293],\n",
       "                {}\n",
       "            ).addTo(map_054942086f2ae4b5ef16c5ebf3c2349d);\n",
       "        \n",
       "    \n",
       "            var icon_291e24b37966804b33a5e1ea10da4d47 = L.AwesomeMarkers.icon(\n",
       "                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;#3237f8&quot;, &quot;markerColor&quot;: &quot;white&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}\n",
       "            );\n",
       "            marker_b7e7fd0f34f5eb87708156afdb37bb85.setIcon(icon_291e24b37966804b33a5e1ea10da4d47);\n",
       "        \n",
       "    \n",
       "        var popup_46d9a43e1460b1e0bb0d2cd767f9dde7 = L.popup({&quot;maxWidth&quot;: 300});\n",
       "\n",
       "        \n",
       "            \n",
       "                var html_6b9430095396fe9a7f23a80c32f38962 = $(`&lt;div id=&quot;html_6b9430095396fe9a7f23a80c32f38962&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;&lt;b&gt;Activity Name:&lt;/b&gt; Kenya Higher Education Partnerhsips&lt;br&gt;&lt;b&gt;Exact Site Name:&lt;/b&gt; Dedan Kimathi University of Technology&lt;br&gt;&lt;b&gt;General Comments:&lt;/b&gt; Consultation and Exploration of EdTech Africa partnership&lt;/div&gt;`)[0];\n",
       "                popup_46d9a43e1460b1e0bb0d2cd767f9dde7.setContent(html_6b9430095396fe9a7f23a80c32f38962);\n",
       "            \n",
       "        \n",
       "\n",
       "        marker_b7e7fd0f34f5eb87708156afdb37bb85.bindPopup(popup_46d9a43e1460b1e0bb0d2cd767f9dde7)\n",
       "        ;\n",
       "\n",
       "        \n",
       "    \n",
       "    \n",
       "            var marker_dd8fd1c0dac62b302e4898ab8e660c96 = L.marker(\n",
       "                [1.286389, 36.817223],\n",
       "                {}\n",
       "            ).addTo(map_054942086f2ae4b5ef16c5ebf3c2349d);\n",
       "        \n",
       "    \n",
       "            var icon_4d48d13623547a99da952a0770108e3a = L.AwesomeMarkers.icon(\n",
       "                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;#3237f8&quot;, &quot;markerColor&quot;: &quot;white&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}\n",
       "            );\n",
       "            marker_dd8fd1c0dac62b302e4898ab8e660c96.setIcon(icon_4d48d13623547a99da952a0770108e3a);\n",
       "        \n",
       "    \n",
       "        var popup_6c85a3840ae1e5e10aeee41c74eed19b = L.popup({&quot;maxWidth&quot;: 300});\n",
       "\n",
       "        \n",
       "            \n",
       "                var html_604de3d466e8c875ccebbdbbf58ded3a = $(`&lt;div id=&quot;html_604de3d466e8c875ccebbdbbf58ded3a&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;&lt;b&gt;Activity Name:&lt;/b&gt; Kenya Higher Education Partnerhsips&lt;br&gt;&lt;b&gt;Exact Site Name:&lt;/b&gt; Kenya Ministry of Education, Nairobi&lt;br&gt;&lt;b&gt;General Comments:&lt;/b&gt; Consultation and Exploration of EdTech Africa partnership&lt;/div&gt;`)[0];\n",
       "                popup_6c85a3840ae1e5e10aeee41c74eed19b.setContent(html_604de3d466e8c875ccebbdbbf58ded3a);\n",
       "            \n",
       "        \n",
       "\n",
       "        marker_dd8fd1c0dac62b302e4898ab8e660c96.bindPopup(popup_6c85a3840ae1e5e10aeee41c74eed19b)\n",
       "        ;\n",
       "\n",
       "        \n",
       "    \n",
       "    \n",
       "            var marker_ebbe945be9912c4e3df623d09f17de39 = L.marker(\n",
       "                [-1.287059, 36.836229],\n",
       "                {}\n",
       "            ).addTo(map_054942086f2ae4b5ef16c5ebf3c2349d);\n",
       "        \n",
       "    \n",
       "            var icon_2b3546f7637e0586d5b7dd957f689f20 = L.AwesomeMarkers.icon(\n",
       "                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;#3237f8&quot;, &quot;markerColor&quot;: &quot;white&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}\n",
       "            );\n",
       "            marker_ebbe945be9912c4e3df623d09f17de39.setIcon(icon_2b3546f7637e0586d5b7dd957f689f20);\n",
       "        \n",
       "    \n",
       "        var popup_4d4daf3b53cdcd894d2ff8c913572485 = L.popup({&quot;maxWidth&quot;: 300});\n",
       "\n",
       "        \n",
       "            \n",
       "                var html_1bc7050499b6692b21398759e2e4770e = $(`&lt;div id=&quot;html_1bc7050499b6692b21398759e2e4770e&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;&lt;b&gt;Activity Name:&lt;/b&gt; Kenya Higher Education Partnerhsips&lt;br&gt;&lt;b&gt;Exact Site Name:&lt;/b&gt; Semiconductor Technology Limited, Mathari Kenya&lt;br&gt;&lt;b&gt;General Comments:&lt;/b&gt; Consultation and Exploration of EdTech Africa partnership&lt;/div&gt;`)[0];\n",
       "                popup_4d4daf3b53cdcd894d2ff8c913572485.setContent(html_1bc7050499b6692b21398759e2e4770e);\n",
       "            \n",
       "        \n",
       "\n",
       "        marker_ebbe945be9912c4e3df623d09f17de39.bindPopup(popup_4d4daf3b53cdcd894d2ff8c913572485)\n",
       "        ;\n",
       "\n",
       "        \n",
       "    \n",
       "    \n",
       "            var marker_b8adb4563a9bd8e8feb0bd27149986eb = L.marker(\n",
       "                [0.517672, 35.272756],\n",
       "                {}\n",
       "            ).addTo(map_054942086f2ae4b5ef16c5ebf3c2349d);\n",
       "        \n",
       "    \n",
       "            var icon_7740ffc9c641b450e170305189a5d9fe = L.AwesomeMarkers.icon(\n",
       "                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;#3237f8&quot;, &quot;markerColor&quot;: &quot;white&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}\n",
       "            );\n",
       "            marker_b8adb4563a9bd8e8feb0bd27149986eb.setIcon(icon_7740ffc9c641b450e170305189a5d9fe);\n",
       "        \n",
       "    \n",
       "        var popup_73777775b0ef61089593b3a40d2663a8 = L.popup({&quot;maxWidth&quot;: 300});\n",
       "\n",
       "        \n",
       "            \n",
       "                var html_6fb60ff2136fd8b48c5ba8d2c79ee2f6 = $(`&lt;div id=&quot;html_6fb60ff2136fd8b48c5ba8d2c79ee2f6&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;&lt;b&gt;Activity Name:&lt;/b&gt; Kenya Higher Education Partnerhsips&lt;br&gt;&lt;b&gt;Exact Site Name:&lt;/b&gt; Moi University&lt;br&gt;&lt;b&gt;General Comments:&lt;/b&gt; Consultation and Exploration of EdTech Africa partnership&lt;/div&gt;`)[0];\n",
       "                popup_73777775b0ef61089593b3a40d2663a8.setContent(html_6fb60ff2136fd8b48c5ba8d2c79ee2f6);\n",
       "            \n",
       "        \n",
       "\n",
       "        marker_b8adb4563a9bd8e8feb0bd27149986eb.bindPopup(popup_73777775b0ef61089593b3a40d2663a8)\n",
       "        ;\n",
       "\n",
       "        \n",
       "    \n",
       "    \n",
       "            var marker_a95685f1c9fd56c1a2214dd4c10b6d01 = L.marker(\n",
       "                [33.7505, -84.4118],\n",
       "                {}\n",
       "            ).addTo(map_054942086f2ae4b5ef16c5ebf3c2349d);\n",
       "        \n",
       "    \n",
       "            var icon_e45597859c2452061a3b111f862ccc55 = L.AwesomeMarkers.icon(\n",
       "                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;#3237f8&quot;, &quot;markerColor&quot;: &quot;white&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}\n",
       "            );\n",
       "            marker_a95685f1c9fd56c1a2214dd4c10b6d01.setIcon(icon_e45597859c2452061a3b111f862ccc55);\n",
       "        \n",
       "    \n",
       "        var popup_10903fb75524f4131fccf67a50979cd7 = L.popup({&quot;maxWidth&quot;: 300});\n",
       "\n",
       "        \n",
       "            \n",
       "                var html_a2ff2d45a83fbfa5f0231e791064fbca = $(`&lt;div id=&quot;html_a2ff2d45a83fbfa5f0231e791064fbca&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;&lt;b&gt;Activity Name:&lt;/b&gt; Kenya Higher Education Partnerhsips&lt;br&gt;&lt;b&gt;Exact Site Name:&lt;/b&gt; Atlanta University Center Consortium Inc.&lt;br&gt;&lt;b&gt;General Comments:&lt;/b&gt; President State Visit and Roundtable Event and Signing of the Framework of Cooperation&lt;/div&gt;`)[0];\n",
       "                popup_10903fb75524f4131fccf67a50979cd7.setContent(html_a2ff2d45a83fbfa5f0231e791064fbca);\n",
       "            \n",
       "        \n",
       "\n",
       "        marker_a95685f1c9fd56c1a2214dd4c10b6d01.bindPopup(popup_10903fb75524f4131fccf67a50979cd7)\n",
       "        ;\n",
       "\n",
       "        \n",
       "    \n",
       "    \n",
       "            var marker_0935abb82b25e57825d1ddd122f042e4 = L.marker(\n",
       "                [3.8482, 11.5021],\n",
       "                {}\n",
       "            ).addTo(map_054942086f2ae4b5ef16c5ebf3c2349d);\n",
       "        \n",
       "    \n",
       "            var icon_6c9f26adb5152da00d656d329f9a57f2 = L.AwesomeMarkers.icon(\n",
       "                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;#3c2341&quot;, &quot;markerColor&quot;: &quot;white&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}\n",
       "            );\n",
       "            marker_0935abb82b25e57825d1ddd122f042e4.setIcon(icon_6c9f26adb5152da00d656d329f9a57f2);\n",
       "        \n",
       "    \n",
       "        var popup_8cb02125703d5fda5dea4bfd7485f0cc = L.popup({&quot;maxWidth&quot;: 300});\n",
       "\n",
       "        \n",
       "            \n",
       "                var html_83873809ab4c4d13317b006a3eafdc58 = $(`&lt;div id=&quot;html_83873809ab4c4d13317b006a3eafdc58&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;&lt;b&gt;Activity Name:&lt;/b&gt; Cameroon Youth Landscape Assessment&lt;br&gt;&lt;b&gt;Exact Site Name:&lt;/b&gt; USAID/Cameroon&lt;br&gt;&lt;b&gt;General Comments:&lt;/b&gt; Activity Kick Off Meeting with USAID&lt;/div&gt;`)[0];\n",
       "                popup_8cb02125703d5fda5dea4bfd7485f0cc.setContent(html_83873809ab4c4d13317b006a3eafdc58);\n",
       "            \n",
       "        \n",
       "\n",
       "        marker_0935abb82b25e57825d1ddd122f042e4.bindPopup(popup_8cb02125703d5fda5dea4bfd7485f0cc)\n",
       "        ;\n",
       "\n",
       "        \n",
       "    \n",
       "    \n",
       "        function geo_json_8a421e7684f46b71f55e181defbb10b9_styler(feature) {\n",
       "            switch(feature.id) {\n",
       "                default:\n",
       "                    return {&quot;color&quot;: &quot;#3237f8&quot;, &quot;fillColor&quot;: &quot;#3237f8&quot;, &quot;fillOpacity&quot;: 0.6, &quot;weight&quot;: 2};\n",
       "            }\n",
       "        }\n",
       "\n",
       "        function geo_json_8a421e7684f46b71f55e181defbb10b9_onEachFeature(feature, layer) {\n",
       "            layer.on({\n",
       "            });\n",
       "        };\n",
       "        var geo_json_8a421e7684f46b71f55e181defbb10b9 = L.geoJson(null, {\n",
       "                onEachFeature: geo_json_8a421e7684f46b71f55e181defbb10b9_onEachFeature,\n",
       "            \n",
       "                style: geo_json_8a421e7684f46b71f55e181defbb10b9_styler,\n",
       "        });\n",
       "\n",
       "        function geo_json_8a421e7684f46b71f55e181defbb10b9_add (data) {\n",
       "            geo_json_8a421e7684f46b71f55e181defbb10b9\n",
       "                .addData(data);\n",
       "        }\n",
       "            geo_json_8a421e7684f46b71f55e181defbb10b9_add({&quot;features&quot;: [{&quot;geometry&quot;: {&quot;coordinates&quot;: [[[40.993, -0.85829], [41.58513, -1.68325], [40.88477, -2.08255], [40.63785, -2.49979], [40.26304, -2.57309], [40.12119, -3.27768], [39.80006, -3.68116], [39.60489, -4.34653], [39.20222, -4.67677], [37.7669, -3.67712], [37.69869, -3.09699], [34.07262, -1.05982], [33.903711, -0.95], [33.893569, 0.109814], [34.18, 0.515], [34.6721, 1.17694], [35.03599, 1.90584], [34.59607, 3.05374], [34.47913, 3.5556], [34.005, 4.249885], [34.620196, 4.847123], [35.298007, 5.506], [35.817448, 5.338232], [35.817448, 4.776966], [36.159079, 4.447864], [36.855093, 4.447864], [38.120915, 3.598605], [38.43697, 3.58851], [38.67114, 3.61607], [38.89251, 3.50074], [39.559384, 3.42206], [39.85494, 3.83879], [40.76848, 4.25702], [41.1718, 3.91909], [41.855083, 3.918912], [40.98105, 2.78452], [40.993, -0.85829]]], &quot;type&quot;: &quot;Polygon&quot;}, &quot;id&quot;: &quot;KEN&quot;, &quot;properties&quot;: {&quot;name&quot;: &quot;Kenya&quot;}, &quot;type&quot;: &quot;Feature&quot;}], &quot;type&quot;: &quot;FeatureCollection&quot;});\n",
       "\n",
       "        \n",
       "    \n",
       "        var popup_7e38b0f46ee8a00dab17780b50f301cd = L.popup({&quot;maxWidth&quot;: 300});\n",
       "\n",
       "        \n",
       "            \n",
       "                var html_9e44bead37811bded93869964c94a7fe = $(`&lt;div id=&quot;html_9e44bead37811bded93869964c94a7fe&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;&lt;b&gt;Activity Name:&lt;/b&gt; Kenya Higher Education Partnerhsips&lt;br&gt;&lt;b&gt;Beneficiary Location Name:&lt;/b&gt; Population in Kenya&lt;/div&gt;`)[0];\n",
       "                popup_7e38b0f46ee8a00dab17780b50f301cd.setContent(html_9e44bead37811bded93869964c94a7fe);\n",
       "            \n",
       "        \n",
       "\n",
       "        geo_json_8a421e7684f46b71f55e181defbb10b9.bindPopup(popup_7e38b0f46ee8a00dab17780b50f301cd)\n",
       "        ;\n",
       "\n",
       "        \n",
       "    \n",
       "    \n",
       "            geo_json_8a421e7684f46b71f55e181defbb10b9.addTo(map_054942086f2ae4b5ef16c5ebf3c2349d);\n",
       "        \n",
       "    \n",
       "        function geo_json_1178a535b85ff069ee244bae708cb1e2_styler(feature) {\n",
       "            switch(feature.id) {\n",
       "                default:\n",
       "                    return {&quot;color&quot;: &quot;#3c2341&quot;, &quot;fillColor&quot;: &quot;#3c2341&quot;, &quot;fillOpacity&quot;: 0.6, &quot;weight&quot;: 2};\n",
       "            }\n",
       "        }\n",
       "\n",
       "        function geo_json_1178a535b85ff069ee244bae708cb1e2_onEachFeature(feature, layer) {\n",
       "            layer.on({\n",
       "            });\n",
       "        };\n",
       "        var geo_json_1178a535b85ff069ee244bae708cb1e2 = L.geoJson(null, {\n",
       "                onEachFeature: geo_json_1178a535b85ff069ee244bae708cb1e2_onEachFeature,\n",
       "            \n",
       "                style: geo_json_1178a535b85ff069ee244bae708cb1e2_styler,\n",
       "        });\n",
       "\n",
       "        function geo_json_1178a535b85ff069ee244bae708cb1e2_add (data) {\n",
       "            geo_json_1178a535b85ff069ee244bae708cb1e2\n",
       "                .addData(data);\n",
       "        }\n",
       "            geo_json_1178a535b85ff069ee244bae708cb1e2_add({&quot;features&quot;: [{&quot;geometry&quot;: {&quot;coordinates&quot;: [[[13.075822, 2.267097], [12.951334, 2.321616], [12.35938, 2.192812], [11.751665, 2.326758], [11.276449, 2.261051], [9.649158, 2.283866], [9.795196, 3.073404], [9.404367, 3.734527], [8.948116, 3.904129], [8.744924, 4.352215], [8.488816, 4.495617], [8.500288, 4.771983], [8.757533, 5.479666], [9.233163, 6.444491], [9.522706, 6.453482], [10.118277, 7.03877], [10.497375, 7.055358], [11.058788, 6.644427], [11.745774, 6.981383], [11.839309, 7.397042], [12.063946, 7.799808], [12.218872, 8.305824], [12.753672, 8.717763], [12.955468, 9.417772], [13.1676, 9.640626], [13.308676, 10.160362], [13.57295, 10.798566], [14.415379, 11.572369], [14.468192, 11.904752], [14.577178, 12.085361], [14.181336, 12.483657], [14.213531, 12.802035], [14.495787, 12.859396], [14.893386, 12.219048], [14.960152, 11.555574], [14.923565, 10.891325], [15.467873, 9.982337], [14.909354, 9.992129], [14.627201, 9.920919], [14.171466, 10.021378], [13.954218, 9.549495], [14.544467, 8.965861], [14.979996, 8.796104], [15.120866, 8.38215], [15.436092, 7.692812], [15.27946, 7.421925], [14.776545, 6.408498], [14.53656, 6.226959], [14.459407, 5.451761], [14.558936, 5.030598], [14.478372, 4.732605], [14.950953, 4.210389], [15.03622, 3.851367], [15.405396, 3.335301], [15.862732, 3.013537], [15.907381, 2.557389], [16.012852, 2.26764], [15.940919, 1.727673], [15.146342, 1.964015], [14.337813, 2.227875], [13.075822, 2.267097]]], &quot;type&quot;: &quot;Polygon&quot;}, &quot;id&quot;: &quot;CMR&quot;, &quot;properties&quot;: {&quot;name&quot;: &quot;Cameroon&quot;}, &quot;type&quot;: &quot;Feature&quot;}], &quot;type&quot;: &quot;FeatureCollection&quot;});\n",
       "\n",
       "        \n",
       "    \n",
       "        var popup_f1de34eeb8222a59b2e7c5346b694328 = L.popup({&quot;maxWidth&quot;: 300});\n",
       "\n",
       "        \n",
       "            \n",
       "                var html_668f57f33e0e09235b09284e7d06b826 = $(`&lt;div id=&quot;html_668f57f33e0e09235b09284e7d06b826&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;&lt;b&gt;Activity Name:&lt;/b&gt; Cameroon Youth Landscape Assessment&lt;br&gt;&lt;b&gt;Beneficiary Location Name:&lt;/b&gt; Population in Cameroon&lt;/div&gt;`)[0];\n",
       "                popup_f1de34eeb8222a59b2e7c5346b694328.setContent(html_668f57f33e0e09235b09284e7d06b826);\n",
       "            \n",
       "        \n",
       "\n",
       "        geo_json_1178a535b85ff069ee244bae708cb1e2.bindPopup(popup_f1de34eeb8222a59b2e7c5346b694328)\n",
       "        ;\n",
       "\n",
       "        \n",
       "    \n",
       "    \n",
       "            geo_json_1178a535b85ff069ee244bae708cb1e2.addTo(map_054942086f2ae4b5ef16c5ebf3c2349d);\n",
       "        \n",
       "    \n",
       "            var marker_a091eae7d05887644e374a05c6845a6f = L.marker(\n",
       "                [4.729117777777777, 20.421554],\n",
       "                {}\n",
       "            ).addTo(map_054942086f2ae4b5ef16c5ebf3c2349d);\n",
       "        \n",
       "    \n",
       "            var div_icon_c6bd54a2600b0bcfbc7f259b6afdf7bc = L.divIcon({&quot;className&quot;: &quot;empty&quot;, &quot;html&quot;: &quot;\\n\\u003cdiv style=\\&quot;position: fixed; \\n     bottom: 50px; left: 50px; width: 250px; height: auto; \\n     border:2px solid grey; z-index:9999; font-size:12px;\\n     background-color:white; opacity: 0.9; padding: 5px;\\n     font-family: \\u0027Gill Sans MT\\u0027, sans-serif; font-style: italic;\\n     max-height: 200px; overflow-y: auto;\\&quot;\\u003e\\n     \\u003cb\\u003eLegend\\u003c/b\\u003e\\u003cbr\\u003e\\n\\u0026nbsp;\\u003ci style=\\&quot;background: #3237f8; width: 20px; height: 20px; border-radius: 50%; display: inline-block; vertical-align: middle;\\&quot;\\u003e\\u003c/i\\u003e\\u0026nbsp;Kenya Higher Education Partnerhsips\\u003cbr\\u003e\\u0026nbsp;\\u003ci style=\\&quot;background: #3c2341; width: 20px; height: 20px; border-radius: 50%; display: inline-block; vertical-align: middle;\\&quot;\\u003e\\u003c/i\\u003e\\u0026nbsp;Cameroon Youth Landscape Assessment\\u003cbr\\u003e\\u003cbr\\u003eClick on the pin/region to read. Pins are for activity locations and colored regions show beneficiary locations\\u003c/div\\u003e&quot;});\n",
       "            marker_a091eae7d05887644e374a05c6845a6f.setIcon(div_icon_c6bd54a2600b0bcfbc7f259b6afdf7bc);\n",
       "        \n",
       "    \n",
       "            tile_layer_9089540e3ea3c81026e241b203bd799b.addTo(map_054942086f2ae4b5ef16c5ebf3c2349d);\n",
       "        \n",
       "    \n",
       "            geo_json_8a421e7684f46b71f55e181defbb10b9.addTo(map_054942086f2ae4b5ef16c5ebf3c2349d);\n",
       "        \n",
       "    \n",
       "            geo_json_1178a535b85ff069ee244bae708cb1e2.addTo(map_054942086f2ae4b5ef16c5ebf3c2349d);\n",
       "        \n",
       "&lt;/script&gt;\n",
       "&lt;/html&gt;\" style=\"position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;\" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div>"
      ],
      "text/plain": [
       "<folium.folium.Map at 0x1c2fa8a2f00>"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Define the geocode function\n",
    "def geocode(location_name):\n",
    "    geolocator = Nominatim(user_agent=\"geoapiExercises\")\n",
    "    location = geolocator.geocode(location_name)\n",
    "    if location:\n",
    "        return [location.latitude, location.longitude]\n",
    "    else:\n",
    "        return None\n",
    "\n",
    "# Load the GeoJSON file for country borders\n",
    "geojson_url = 'https://raw.githubusercontent.com/johan/world.geo.json/master/countries.geo.json'\n",
    "country_geojson = requests.get(geojson_url).json()\n",
    "\n",
    "# Load the Excel file\n",
    "\n",
    "\n",
    "file_path = 'C:/Users/MitiShah/OneDrive - International Development Group/OASIS ALOA/Technical Deliverables/Geographic Data Reporting/04.2022-06.2024/04.2024_06.2024_geographic_data.xlsx'\n",
    "sheet2 = pd.read_excel(file_path, sheet_name='Sheet2')\n",
    "sheet3 = pd.read_excel(file_path, sheet_name='Sheet3')\n",
    "\n",
    "# Combine latitude and longitude data from both sheets\n",
    "all_latitudes = pd.concat([sheet2['Exact Site Latitude'], sheet3['Beneficiary Latitude']])\n",
    "all_longitudes = pd.concat([sheet2['Exact Site Longitude'], sheet3['Beneficiary Longitude']])\n",
    "\n",
    "# Calculate the average latitude and longitude for centering the map\n",
    "avg_lat = all_latitudes.mean()\n",
    "avg_lon = all_longitudes.mean()\n",
    "mymap = folium.Map(location=[avg_lat, avg_lon], zoom_start=2)\n",
    "\n",
    "# Function to generate random color\n",
    "def generate_random_color():\n",
    "    return \"#{:06x}\".format(random.randint(0, 0xFFFFFF))\n",
    "\n",
    "# Create a unique color for each activity name and ensure consistency across sheets\n",
    "activity_colors = {}\n",
    "activity_names = set(sheet2['Activity Name'].unique()).union(set(sheet3['Activity Name'].unique()))\n",
    "for activity_name in activity_names:\n",
    "    if activity_name not in activity_colors:\n",
    "        activity_colors[activity_name] = generate_random_color()\n",
    "\n",
    "# Add pins for Sheet2 data with full-color matching the activity names\n",
    "for idx, row in sheet2.iterrows():\n",
    "    popup_text = f\"<b>Activity Name:</b> {row['Activity Name']}<br><b>Exact Site Name:</b> {row['Exact Site Name']}<br><b>General Comments:</b> {row['General Comments']}\"\n",
    "    popup = folium.Popup(popup_text, max_width=300)\n",
    "    folium.Marker(\n",
    "        location=[row['Exact Site Latitude'], row['Exact Site Longitude']],\n",
    "        popup=popup,\n",
    "        icon=folium.Icon(\n",
    "            color='white',  # Use white background for better contrast\n",
    "            icon_color=activity_colors[row['Activity Name']],\n",
    "            icon='info-sign'  # You can change this to another icon if needed\n",
    "        )\n",
    "    ).add_to(mymap)\n",
    "\n",
    "# Add colored regions for Sheet3 data\n",
    "for idx, row in sheet3.iterrows():\n",
    "    popup_text = f\"<b>Activity Name:</b> {row['Activity Name']}<br><b>Beneficiary Location Name:</b> {row['Beneficiary Location Name']}\"\n",
    "    popup = folium.Popup(popup_text, max_width=300)\n",
    "    if row['Beneficiary Admin Level'] == 0:\n",
    "        # Color the entire country\n",
    "        country_name = row['Beneficiary Admin Unit Name']\n",
    "        for feature in country_geojson['features']:\n",
    "            if feature['properties']['name'].lower() == country_name.lower():\n",
    "                folium.GeoJson(\n",
    "                    feature,\n",
    "                    style_function=lambda x, color=activity_colors[row['Activity Name']]: {\n",
    "                        'fillColor': color,\n",
    "                        'color': color,\n",
    "                        'weight': 2,\n",
    "                        'fillOpacity': 0.6,\n",
    "                    },\n",
    "                    popup=popup\n",
    "                ).add_to(mymap)\n",
    "    else:\n",
    "        # Use latitude and longitude\n",
    "        location = [row['Beneficiary Latitude'], row['Beneficiary Longitude']]\n",
    "        folium.CircleMarker(\n",
    "            location=location,\n",
    "            radius=10,\n",
    "            color=activity_colors[row['Activity Name']],\n",
    "            fill=True,\n",
    "            fill_color=activity_colors[row['Activity Name']],\n",
    "            fill_opacity=0.6,\n",
    "            popup=popup\n",
    "        ).add_to(mymap)\n",
    "\n",
    "# Define the legend HTML with reduced height\n",
    "legend_html = \"\"\"\n",
    "<div style=\"position: fixed; \n",
    "     bottom: 50px; left: 50px; width: 250px; height: auto; \n",
    "     border:2px solid grey; z-index:9999; font-size:12px;\n",
    "     background-color:white; opacity: 0.9; padding: 5px;\n",
    "     font-family: 'Gill Sans MT', sans-serif; font-style: italic;\n",
    "     max-height: 200px; overflow-y: auto;\">\n",
    "     <b>Legend</b><br>\n",
    "\"\"\"\n",
    "for activity, color in activity_colors.items():\n",
    "    legend_html += f\"&nbsp;<i style=\\\"background: {color}; width: 20px; height: 20px; border-radius: 50%; display: inline-block; vertical-align: middle;\\\"></i>&nbsp;{activity}<br>\"\n",
    "legend_html += \"<br>Click on the pin/region to read. Pins are for activity locations and colored regions show beneficiary locations</div>\"\n",
    "\n",
    "# Add the legend to the map\n",
    "legend = folium.Marker(\n",
    "    location=[avg_lat, avg_lon],\n",
    "    icon=folium.DivIcon(html=legend_html)\n",
    ")\n",
    "legend.add_to(mymap)\n",
    "\n",
    "# Save the map to an HTML file\n",
    "html_file_path ='C:/Users/MitiShah/OneDrive - International Development Group/OASIS ALOA/Technical Deliverables/Geographic Data Reporting/04.2022-06.2024/aloa_qpr3.html'\n",
    "mymap.save(html_file_path)\n",
    "mymap"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f517334-5c27-4b1e-aaf8-92aeb1c74fa6",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
